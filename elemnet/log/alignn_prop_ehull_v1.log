
2024-02-29 04:40:28.849096:job config: {'train_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_train.csv', 'val_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_val.csv', 'test_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_test.csv', 'label': 'ehull', 'input_type': None, 'log_folder': 'log', 'log_file': 'alignn_prop_ehull.log', 'test_metric': 'mae', 'architecture': '1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1', 'model_seed': 0, 'loss_type': 'mae', 'config_file': 'sample/alignn_prop_ehull_job.config', 'use_valid': True, 'project': 'LLM', 'regressors': None, 'input_types': None, 'paramsGrid': {'optimizer': 'Adam', 'learning_rate': 0.0001, 'patience': 100, 'dropouts': [0.8, 0.9, 0.7, 0.8], 'EVAL_FREQUENCY': 1000}, 'save_path': 'sample/alignn_prop_ehull', 'model_path': None, 'last_layer_with_weight': True, 'keras_path': 'model/alignn_prop_ehull', 'test_size': None, 'val_size': None}
2024-02-29 04:40:28.849160:train data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_train.csv
2024-02-29 04:40:35.745112:input attribute sets are:  None
2024-02-29 04:40:35.745387:test data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_test.csv
2024-02-29 04:40:36.583624:val data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/alignn_bert-base-uncased_chemnlp_prop_ehull_val.csv
2024-02-29 04:40:37.424715:input attributes are:  Index(['0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
       ...
       '758', '759', '760', '761', '762', '763', '764', '765', '766', '767'],
      dtype='object', length=768)
2024-02-29 04:40:37.424839:label: ehull
2024-02-29 04:40:43.833363: train, test, valid sizes:  (59939, 768) (59939,) (7493, 768) (7493,) (7494, 768) (7494,)
2024-02-29 04:40:43.966342:train matrix shape of train_X:  (59939, 768)  train_y:  (59939,)
2024-02-29 04:40:43.966486:valid matrix shape of train_X:  (7494, 768)  valid_y:  (7494,)
2024-02-29 04:40:43.966525:test matrix shape of valid_X:   (7493, 768)  test_y:  (7493,)
2024-02-29 04:40:43.966559:architecture is:  1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1
2024-02-29 04:40:43.966595:learning rate is  0.0001
2024-02-29 04:40:43.966627:model path is  None
2024-02-29 04:40:43.982970:adding fully connected layers with 1024 outputs
2024-02-29 04:40:46.448964:adding residual with fc as the size are different
2024-02-29 04:40:46.455833:adding fully connected layers with 1024 outputs
2024-02-29 04:40:46.460886:adding residual, both sizes are same
2024-02-29 04:40:46.462781:adding fully connected layers with 1024 outputs
2024-02-29 04:40:46.467725:adding residual, both sizes are same
2024-02-29 04:40:46.469574:adding fully connected layers with 1024 outputs
2024-02-29 04:40:46.474233:adding residual, both sizes are same
2024-02-29 04:40:46.476187:adding dropout 0.8
2024-02-29 04:40:46.480594:adding fully connected layers with 512 outputs
2024-02-29 04:40:46.485608:adding residual with fc as the size are different
2024-02-29 04:40:46.492509:adding fully connected layers with 512 outputs
2024-02-29 04:40:46.497467:adding residual, both sizes are same
2024-02-29 04:40:46.499294:adding fully connected layers with 512 outputs
2024-02-29 04:40:46.504118:adding residual, both sizes are same
2024-02-29 04:40:46.505965:adding dropout 0.9
2024-02-29 04:40:46.507591:adding fully connected layers with 256 outputs
2024-02-29 04:40:46.512585:adding residual with fc as the size are different
2024-02-29 04:40:46.522345:adding fully connected layers with 256 outputs
2024-02-29 04:40:46.532025:adding residual, both sizes are same
2024-02-29 04:40:46.534519:adding fully connected layers with 256 outputs
2024-02-29 04:40:46.540337:adding residual, both sizes are same
2024-02-29 04:40:46.542266:adding dropout 0.7
2024-02-29 04:40:46.543901:adding fully connected layers with 128 outputs
2024-02-29 04:40:46.548970:adding residual with fc as the size are different
2024-02-29 04:40:46.555507:adding fully connected layers with 128 outputs
2024-02-29 04:40:46.560414:adding residual, both sizes are same
2024-02-29 04:40:46.562331:adding fully connected layers with 128 outputs
2024-02-29 04:40:46.567132:adding residual, both sizes are same
2024-02-29 04:40:46.569228:adding dropout 0.8
2024-02-29 04:40:46.570873:adding fully connected layers with 64 outputs
2024-02-29 04:40:46.575873:adding residual with fc as the size are different
2024-02-29 04:40:46.582009:adding fully connected layers with 64 outputs
2024-02-29 04:40:46.587055:adding residual, both sizes are same
2024-02-29 04:40:46.588935:adding fully connected layers with 32 outputs
2024-02-29 04:40:46.593941:adding residual with fc as the size are different
2024-02-29 04:40:46.600384:adding final layer with 1 output
2024-02-29 04:40:46.609935:Model: "ElemNet"
2024-02-29 04:40:46.610009:__________________________________________________________________________________________________
2024-02-29 04:40:46.610058:Layer (type)                    Output Shape         Param #     Connected to                     
2024-02-29 04:40:46.610095:==================================================================================================
2024-02-29 04:40:46.610296:elemental_fractions (InputLayer [(None, 768)]        0                                            
2024-02-29 04:40:46.610352:__________________________________________________________________________________________________
2024-02-29 04:40:46.610503:fc0_0 (Dense)                   (None, 1024)         787456      elemental_fractions[0][0]        
2024-02-29 04:40:46.610550:__________________________________________________________________________________________________
2024-02-29 04:40:46.610662:fc0_dim_0 (Dense)               (None, 1024)         787456      elemental_fractions[0][0]        
2024-02-29 04:40:46.610706:__________________________________________________________________________________________________
2024-02-29 04:40:46.610789:tf.__operators__.add (TFOpLambd (None, 1024)         0           fc0_0[0][0]                      
2024-02-29 04:40:46.610832:                                                                 fc0_dim_0[0][0]                  
2024-02-29 04:40:46.610871:__________________________________________________________________________________________________
2024-02-29 04:40:46.610974:fc0_1 (Dense)                   (None, 1024)         1049600     tf.__operators__.add[0][0]       
2024-02-29 04:40:46.611016:__________________________________________________________________________________________________
2024-02-29 04:40:46.611094:tf.__operators__.add_1 (TFOpLam (None, 1024)         0           fc0_1[0][0]                      
2024-02-29 04:40:46.611136:                                                                 tf.__operators__.add[0][0]       
2024-02-29 04:40:46.611171:__________________________________________________________________________________________________
2024-02-29 04:40:46.611272:fc0_2 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_1[0][0]     
2024-02-29 04:40:46.611314:__________________________________________________________________________________________________
2024-02-29 04:40:46.611400:tf.__operators__.add_2 (TFOpLam (None, 1024)         0           fc0_2[0][0]                      
2024-02-29 04:40:46.611443:                                                                 tf.__operators__.add_1[0][0]     
2024-02-29 04:40:46.611478:__________________________________________________________________________________________________
2024-02-29 04:40:46.611579:fc0_3 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_2[0][0]     
2024-02-29 04:40:46.611622:__________________________________________________________________________________________________
2024-02-29 04:40:46.611696:tf.__operators__.add_3 (TFOpLam (None, 1024)         0           fc0_3[0][0]                      
2024-02-29 04:40:46.611738:                                                                 tf.__operators__.add_2[0][0]     
2024-02-29 04:40:46.611773:__________________________________________________________________________________________________
2024-02-29 04:40:46.611855:dropout (Dropout)               (None, 1024)         0           tf.__operators__.add_3[0][0]     
2024-02-29 04:40:46.611894:__________________________________________________________________________________________________
2024-02-29 04:40:46.611998:fc1_0 (Dense)                   (None, 512)          524800      dropout[0][0]                    
2024-02-29 04:40:46.612041:__________________________________________________________________________________________________
2024-02-29 04:40:46.612143:fc1_dim_0 (Dense)               (None, 512)          524800      dropout[0][0]                    
2024-02-29 04:40:46.612185:__________________________________________________________________________________________________
2024-02-29 04:40:46.612261:tf.__operators__.add_4 (TFOpLam (None, 512)          0           fc1_0[0][0]                      
2024-02-29 04:40:46.612303:                                                                 fc1_dim_0[0][0]                  
2024-02-29 04:40:46.612346:__________________________________________________________________________________________________
2024-02-29 04:40:46.612449:fc1_1 (Dense)                   (None, 512)          262656      tf.__operators__.add_4[0][0]     
2024-02-29 04:40:46.612491:__________________________________________________________________________________________________
2024-02-29 04:40:46.612567:tf.__operators__.add_5 (TFOpLam (None, 512)          0           fc1_1[0][0]                      
2024-02-29 04:40:46.612610:                                                                 tf.__operators__.add_4[0][0]     
2024-02-29 04:40:46.612645:__________________________________________________________________________________________________
2024-02-29 04:40:46.612744:fc1_2 (Dense)                   (None, 512)          262656      tf.__operators__.add_5[0][0]     
2024-02-29 04:40:46.612786:__________________________________________________________________________________________________
2024-02-29 04:40:46.612860:tf.__operators__.add_6 (TFOpLam (None, 512)          0           fc1_2[0][0]                      
2024-02-29 04:40:46.612902:                                                                 tf.__operators__.add_5[0][0]     
2024-02-29 04:40:46.612938:__________________________________________________________________________________________________
2024-02-29 04:40:46.613009:dropout_1 (Dropout)             (None, 512)          0           tf.__operators__.add_6[0][0]     
2024-02-29 04:40:46.613046:__________________________________________________________________________________________________
2024-02-29 04:40:46.613146:fc2_0 (Dense)                   (None, 256)          131328      dropout_1[0][0]                  
2024-02-29 04:40:46.613188:__________________________________________________________________________________________________
2024-02-29 04:40:46.613287:fc2_dim_0 (Dense)               (None, 256)          131328      dropout_1[0][0]                  
2024-02-29 04:40:46.613336:__________________________________________________________________________________________________
2024-02-29 04:40:46.613412:tf.__operators__.add_7 (TFOpLam (None, 256)          0           fc2_0[0][0]                      
2024-02-29 04:40:46.613455:                                                                 fc2_dim_0[0][0]                  
2024-02-29 04:40:46.613492:__________________________________________________________________________________________________
2024-02-29 04:40:46.613591:fc2_1 (Dense)                   (None, 256)          65792       tf.__operators__.add_7[0][0]     
2024-02-29 04:40:46.613631:__________________________________________________________________________________________________
2024-02-29 04:40:46.613706:tf.__operators__.add_8 (TFOpLam (None, 256)          0           fc2_1[0][0]                      
2024-02-29 04:40:46.613747:                                                                 tf.__operators__.add_7[0][0]     
2024-02-29 04:40:46.613790:__________________________________________________________________________________________________
2024-02-29 04:40:46.613890:fc2_2 (Dense)                   (None, 256)          65792       tf.__operators__.add_8[0][0]     
2024-02-29 04:40:46.613951:__________________________________________________________________________________________________
2024-02-29 04:40:46.614029:tf.__operators__.add_9 (TFOpLam (None, 256)          0           fc2_2[0][0]                      
2024-02-29 04:40:46.614071:                                                                 tf.__operators__.add_8[0][0]     
2024-02-29 04:40:46.614107:__________________________________________________________________________________________________
2024-02-29 04:40:46.614176:dropout_2 (Dropout)             (None, 256)          0           tf.__operators__.add_9[0][0]     
2024-02-29 04:40:46.614215:__________________________________________________________________________________________________
2024-02-29 04:40:46.614316:fc3_0 (Dense)                   (None, 128)          32896       dropout_2[0][0]                  
2024-02-29 04:40:46.614365:__________________________________________________________________________________________________
2024-02-29 04:40:46.614512:fc3_dim_0 (Dense)               (None, 128)          32896       dropout_2[0][0]                  
2024-02-29 04:40:46.614562:__________________________________________________________________________________________________
2024-02-29 04:40:46.614645:tf.__operators__.add_10 (TFOpLa (None, 128)          0           fc3_0[0][0]                      
2024-02-29 04:40:46.614689:                                                                 fc3_dim_0[0][0]                  
2024-02-29 04:40:46.614724:__________________________________________________________________________________________________
2024-02-29 04:40:46.614824:fc3_1 (Dense)                   (None, 128)          16512       tf.__operators__.add_10[0][0]    
2024-02-29 04:40:46.614867:__________________________________________________________________________________________________
2024-02-29 04:40:46.614940:tf.__operators__.add_11 (TFOpLa (None, 128)          0           fc3_1[0][0]                      
2024-02-29 04:40:46.614983:                                                                 tf.__operators__.add_10[0][0]    
2024-02-29 04:40:46.615018:__________________________________________________________________________________________________
2024-02-29 04:40:46.615116:fc3_2 (Dense)                   (None, 128)          16512       tf.__operators__.add_11[0][0]    
2024-02-29 04:40:46.615158:__________________________________________________________________________________________________
2024-02-29 04:40:46.615232:tf.__operators__.add_12 (TFOpLa (None, 128)          0           fc3_2[0][0]                      
2024-02-29 04:40:46.615274:                                                                 tf.__operators__.add_11[0][0]    
2024-02-29 04:40:46.615310:__________________________________________________________________________________________________
2024-02-29 04:40:46.615399:dropout_3 (Dropout)             (None, 128)          0           tf.__operators__.add_12[0][0]    
2024-02-29 04:40:46.615438:__________________________________________________________________________________________________
2024-02-29 04:40:46.615541:fc4_0 (Dense)                   (None, 64)           8256        dropout_3[0][0]                  
2024-02-29 04:40:46.615584:__________________________________________________________________________________________________
2024-02-29 04:40:46.615683:fc4_dim_0 (Dense)               (None, 64)           8256        dropout_3[0][0]                  
2024-02-29 04:40:46.615726:__________________________________________________________________________________________________
2024-02-29 04:40:46.615799:tf.__operators__.add_13 (TFOpLa (None, 64)           0           fc4_0[0][0]                      
2024-02-29 04:40:46.615842:                                                                 fc4_dim_0[0][0]                  
2024-02-29 04:40:46.615882:__________________________________________________________________________________________________
2024-02-29 04:40:46.615983:fc4_1 (Dense)                   (None, 64)           4160        tf.__operators__.add_13[0][0]    
2024-02-29 04:40:46.616024:__________________________________________________________________________________________________
2024-02-29 04:40:46.616097:tf.__operators__.add_14 (TFOpLa (None, 64)           0           fc4_1[0][0]                      
2024-02-29 04:40:46.616140:                                                                 tf.__operators__.add_13[0][0]    
2024-02-29 04:40:46.616175:__________________________________________________________________________________________________
2024-02-29 04:40:46.616272:fc5_0 (Dense)                   (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-02-29 04:40:46.616314:__________________________________________________________________________________________________
2024-02-29 04:40:46.616424:fc5_dim_0 (Dense)               (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-02-29 04:40:46.616467:__________________________________________________________________________________________________
2024-02-29 04:40:46.616542:tf.__operators__.add_15 (TFOpLa (None, 32)           0           fc5_0[0][0]                      
2024-02-29 04:40:46.616584:                                                                 fc5_dim_0[0][0]                  
2024-02-29 04:40:46.616619:__________________________________________________________________________________________________
2024-02-29 04:40:46.616718:fc6 (Dense)                     (None, 1)            33          tf.__operators__.add_15[0][0]    
2024-02-29 04:40:46.616759:==================================================================================================
2024-02-29 04:40:46.617356:Total params: 6,816,545
2024-02-29 04:40:46.617517:Trainable params: 6,816,545
2024-02-29 04:40:46.617718:Non-trainable params: 0
2024-02-29 04:40:46.617858:__________________________________________________________________________________________________
2024-02-29 04:40:46.633078:start training