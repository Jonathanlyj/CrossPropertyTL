
2024-03-20 00:32:17.936388:job config: {'train_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_train.csv', 'val_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_val.csv', 'test_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_test.csv', 'label': 'mbj_bandgap', 'input_type': None, 'log_folder': 'log', 'log_file': 'alignn_bert-base-uncased_robo_prop_mbj_bandgap.log', 'test_metric': 'mae', 'architecture': '1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1', 'model_seed': 0, 'loss_type': 'mae', 'config_file': 'sample/alignn_bert-base-uncased_robo_prop_mbj_bandgap_job.config', 'use_valid': True, 'project': 'MOF', 'regressors': None, 'input_types': None, 'paramsGrid': {'optimizer': 'Adam', 'learning_rate': 0.0001, 'patience': 100, 'dropouts': [0.8, 0.9, 0.7, 0.8], 'EVAL_FREQUENCY': 1000}, 'save_path': 'sample/alignn_bert-base-uncased_robo_prop_mbj_bandgap', 'model_path': None, 'last_layer_with_weight': True, 'keras_path': 'model/alignn_bert-base-uncased_robo_prop_mbj_bandgap', 'test_size': None, 'val_size': None}
2024-03-20 00:32:17.936448:train data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_train.csv
2024-03-20 00:32:21.797525:input attribute sets are:  None
2024-03-20 00:32:21.797913:test data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_test.csv
2024-03-20 00:32:22.298660:val data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_robo_prop_mbj_bandgap_val.csv
2024-03-20 00:32:22.842537:input attributes are:  Index(['0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
       ...
       '758.1', '759.1', '760.1', '761.1', '762.1', '763.1', '764.1', '765.1',
       '766.1', '767.1'],
      dtype='object', length=1536)
2024-03-20 00:32:22.842716:label: mbj_bandgap
2024-03-20 00:32:31.945794: train, test, valid sizes:  (15642, 1536) (15642,) (1957, 1536) (1957,) (1957, 1536) (1957,)
2024-03-20 00:32:32.017978:train matrix shape of train_X:  (15642, 1536)  train_y:  (15642,)
2024-03-20 00:32:32.018105:valid matrix shape of train_X:  (1957, 1536)  valid_y:  (1957,)
2024-03-20 00:32:32.018145:test matrix shape of valid_X:   (1957, 1536)  test_y:  (1957,)
2024-03-20 00:32:32.018178:architecture is:  1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1
2024-03-20 00:32:32.018212:learning rate is  0.0001
2024-03-20 00:32:32.018244:model path is  None
2024-03-20 00:32:32.029787:adding fully connected layers with 1024 outputs
2024-03-20 00:32:32.605985:adding residual with fc as the size are different
2024-03-20 00:32:32.613764:adding fully connected layers with 1024 outputs
2024-03-20 00:32:32.619135:adding residual, both sizes are same
2024-03-20 00:32:32.621175:adding fully connected layers with 1024 outputs
2024-03-20 00:32:32.626266:adding residual, both sizes are same
2024-03-20 00:32:32.628195:adding fully connected layers with 1024 outputs
2024-03-20 00:32:32.633212:adding residual, both sizes are same
2024-03-20 00:32:32.635561:adding dropout 0.8
2024-03-20 00:32:32.641537:adding fully connected layers with 512 outputs
2024-03-20 00:32:32.647265:adding residual with fc as the size are different
2024-03-20 00:32:32.661775:adding fully connected layers with 512 outputs
2024-03-20 00:32:32.670887:adding residual, both sizes are same
2024-03-20 00:32:32.672882:adding fully connected layers with 512 outputs
2024-03-20 00:32:32.678953:adding residual, both sizes are same
2024-03-20 00:32:32.680890:adding dropout 0.9
2024-03-20 00:32:32.682560:adding fully connected layers with 256 outputs
2024-03-20 00:32:32.687503:adding residual with fc as the size are different
2024-03-20 00:32:32.694060:adding fully connected layers with 256 outputs
2024-03-20 00:32:32.698997:adding residual, both sizes are same
2024-03-20 00:32:32.700926:adding fully connected layers with 256 outputs
2024-03-20 00:32:32.705939:adding residual, both sizes are same
2024-03-20 00:32:32.707795:adding dropout 0.7
2024-03-20 00:32:32.709433:adding fully connected layers with 128 outputs
2024-03-20 00:32:32.714514:adding residual with fc as the size are different
2024-03-20 00:32:32.721062:adding fully connected layers with 128 outputs
2024-03-20 00:32:32.726010:adding residual, both sizes are same
2024-03-20 00:32:32.727903:adding fully connected layers with 128 outputs
2024-03-20 00:32:32.739361:adding residual, both sizes are same
2024-03-20 00:32:32.742540:adding dropout 0.8
2024-03-20 00:32:32.744968:adding fully connected layers with 64 outputs
2024-03-20 00:32:32.751403:adding residual with fc as the size are different
2024-03-20 00:32:32.766092:adding fully connected layers with 64 outputs
2024-03-20 00:32:32.772934:adding residual, both sizes are same
2024-03-20 00:32:32.774816:adding fully connected layers with 32 outputs
2024-03-20 00:32:32.779697:adding residual with fc as the size are different
2024-03-20 00:32:32.786096:adding final layer with 1 output
2024-03-20 00:32:32.796177:Model: "ElemNet"
2024-03-20 00:32:32.796246:__________________________________________________________________________________________________
2024-03-20 00:32:32.796296:Layer (type)                    Output Shape         Param #     Connected to                     
2024-03-20 00:32:32.796332:==================================================================================================
2024-03-20 00:32:32.796567:elemental_fractions (InputLayer [(None, 1536)]       0                                            
2024-03-20 00:32:32.796617:__________________________________________________________________________________________________
2024-03-20 00:32:32.796771:fc0_0 (Dense)                   (None, 1024)         1573888     elemental_fractions[0][0]        
2024-03-20 00:32:32.796816:__________________________________________________________________________________________________
2024-03-20 00:32:32.796927:fc0_dim_0 (Dense)               (None, 1024)         1573888     elemental_fractions[0][0]        
2024-03-20 00:32:32.796970:__________________________________________________________________________________________________
2024-03-20 00:32:32.797052:tf.__operators__.add (TFOpLambd (None, 1024)         0           fc0_0[0][0]                      
2024-03-20 00:32:32.797095:                                                                 fc0_dim_0[0][0]                  
2024-03-20 00:32:32.797130:__________________________________________________________________________________________________
2024-03-20 00:32:32.797234:fc0_1 (Dense)                   (None, 1024)         1049600     tf.__operators__.add[0][0]       
2024-03-20 00:32:32.797275:__________________________________________________________________________________________________
2024-03-20 00:32:32.797351:tf.__operators__.add_1 (TFOpLam (None, 1024)         0           fc0_1[0][0]                      
2024-03-20 00:32:32.797392:                                                                 tf.__operators__.add[0][0]       
2024-03-20 00:32:32.797427:__________________________________________________________________________________________________
2024-03-20 00:32:32.797534:fc0_2 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_1[0][0]     
2024-03-20 00:32:32.797576:__________________________________________________________________________________________________
2024-03-20 00:32:32.797652:tf.__operators__.add_2 (TFOpLam (None, 1024)         0           fc0_2[0][0]                      
2024-03-20 00:32:32.797694:                                                                 tf.__operators__.add_1[0][0]     
2024-03-20 00:32:32.797729:__________________________________________________________________________________________________
2024-03-20 00:32:32.797827:fc0_3 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_2[0][0]     
2024-03-20 00:32:32.797868:__________________________________________________________________________________________________
2024-03-20 00:32:32.797942:tf.__operators__.add_3 (TFOpLam (None, 1024)         0           fc0_3[0][0]                      
2024-03-20 00:32:32.797991:                                                                 tf.__operators__.add_2[0][0]     
2024-03-20 00:32:32.798026:__________________________________________________________________________________________________
2024-03-20 00:32:32.798100:dropout (Dropout)               (None, 1024)         0           tf.__operators__.add_3[0][0]     
2024-03-20 00:32:32.798138:__________________________________________________________________________________________________
2024-03-20 00:32:32.798238:fc1_0 (Dense)                   (None, 512)          524800      dropout[0][0]                    
2024-03-20 00:32:32.798278:__________________________________________________________________________________________________
2024-03-20 00:32:32.798376:fc1_dim_0 (Dense)               (None, 512)          524800      dropout[0][0]                    
2024-03-20 00:32:32.798416:__________________________________________________________________________________________________
2024-03-20 00:32:32.798496:tf.__operators__.add_4 (TFOpLam (None, 512)          0           fc1_0[0][0]                      
2024-03-20 00:32:32.798539:                                                                 fc1_dim_0[0][0]                  
2024-03-20 00:32:32.798574:__________________________________________________________________________________________________
2024-03-20 00:32:32.798673:fc1_1 (Dense)                   (None, 512)          262656      tf.__operators__.add_4[0][0]     
2024-03-20 00:32:32.798714:__________________________________________________________________________________________________
2024-03-20 00:32:32.798787:tf.__operators__.add_5 (TFOpLam (None, 512)          0           fc1_1[0][0]                      
2024-03-20 00:32:32.798829:                                                                 tf.__operators__.add_4[0][0]     
2024-03-20 00:32:32.798863:__________________________________________________________________________________________________
2024-03-20 00:32:32.798961:fc1_2 (Dense)                   (None, 512)          262656      tf.__operators__.add_5[0][0]     
2024-03-20 00:32:32.799001:__________________________________________________________________________________________________
2024-03-20 00:32:32.799075:tf.__operators__.add_6 (TFOpLam (None, 512)          0           fc1_2[0][0]                      
2024-03-20 00:32:32.799117:                                                                 tf.__operators__.add_5[0][0]     
2024-03-20 00:32:32.799151:__________________________________________________________________________________________________
2024-03-20 00:32:32.799221:dropout_1 (Dropout)             (None, 512)          0           tf.__operators__.add_6[0][0]     
2024-03-20 00:32:32.799258:__________________________________________________________________________________________________
2024-03-20 00:32:32.799356:fc2_0 (Dense)                   (None, 256)          131328      dropout_1[0][0]                  
2024-03-20 00:32:32.799396:__________________________________________________________________________________________________
2024-03-20 00:32:32.799500:fc2_dim_0 (Dense)               (None, 256)          131328      dropout_1[0][0]                  
2024-03-20 00:32:32.799541:__________________________________________________________________________________________________
2024-03-20 00:32:32.799614:tf.__operators__.add_7 (TFOpLam (None, 256)          0           fc2_0[0][0]                      
2024-03-20 00:32:32.799656:                                                                 fc2_dim_0[0][0]                  
2024-03-20 00:32:32.799691:__________________________________________________________________________________________________
2024-03-20 00:32:32.799788:fc2_1 (Dense)                   (None, 256)          65792       tf.__operators__.add_7[0][0]     
2024-03-20 00:32:32.799828:__________________________________________________________________________________________________
2024-03-20 00:32:32.799907:tf.__operators__.add_8 (TFOpLam (None, 256)          0           fc2_1[0][0]                      
2024-03-20 00:32:32.799949:                                                                 tf.__operators__.add_7[0][0]     
2024-03-20 00:32:32.799984:__________________________________________________________________________________________________
2024-03-20 00:32:32.800081:fc2_2 (Dense)                   (None, 256)          65792       tf.__operators__.add_8[0][0]     
2024-03-20 00:32:32.800136:__________________________________________________________________________________________________
2024-03-20 00:32:32.800211:tf.__operators__.add_9 (TFOpLam (None, 256)          0           fc2_2[0][0]                      
2024-03-20 00:32:32.800253:                                                                 tf.__operators__.add_8[0][0]     
2024-03-20 00:32:32.800287:__________________________________________________________________________________________________
2024-03-20 00:32:32.800356:dropout_2 (Dropout)             (None, 256)          0           tf.__operators__.add_9[0][0]     
2024-03-20 00:32:32.800393:__________________________________________________________________________________________________
2024-03-20 00:32:32.800537:fc3_0 (Dense)                   (None, 128)          32896       dropout_2[0][0]                  
2024-03-20 00:32:32.800586:__________________________________________________________________________________________________
2024-03-20 00:32:32.800697:fc3_dim_0 (Dense)               (None, 128)          32896       dropout_2[0][0]                  
2024-03-20 00:32:32.800740:__________________________________________________________________________________________________
2024-03-20 00:32:32.800816:tf.__operators__.add_10 (TFOpLa (None, 128)          0           fc3_0[0][0]                      
2024-03-20 00:32:32.800859:                                                                 fc3_dim_0[0][0]                  
2024-03-20 00:32:32.800895:__________________________________________________________________________________________________
2024-03-20 00:32:32.800995:fc3_1 (Dense)                   (None, 128)          16512       tf.__operators__.add_10[0][0]    
2024-03-20 00:32:32.801036:__________________________________________________________________________________________________
2024-03-20 00:32:32.801112:tf.__operators__.add_11 (TFOpLa (None, 128)          0           fc3_1[0][0]                      
2024-03-20 00:32:32.801154:                                                                 tf.__operators__.add_10[0][0]    
2024-03-20 00:32:32.801190:__________________________________________________________________________________________________
2024-03-20 00:32:32.801290:fc3_2 (Dense)                   (None, 128)          16512       tf.__operators__.add_11[0][0]    
2024-03-20 00:32:32.801330:__________________________________________________________________________________________________
2024-03-20 00:32:32.801405:tf.__operators__.add_12 (TFOpLa (None, 128)          0           fc3_2[0][0]                      
2024-03-20 00:32:32.801447:                                                                 tf.__operators__.add_11[0][0]    
2024-03-20 00:32:32.801493:__________________________________________________________________________________________________
2024-03-20 00:32:32.801566:dropout_3 (Dropout)             (None, 128)          0           tf.__operators__.add_12[0][0]    
2024-03-20 00:32:32.801604:__________________________________________________________________________________________________
2024-03-20 00:32:32.801706:fc4_0 (Dense)                   (None, 64)           8256        dropout_3[0][0]                  
2024-03-20 00:32:32.801747:__________________________________________________________________________________________________
2024-03-20 00:32:32.801848:fc4_dim_0 (Dense)               (None, 64)           8256        dropout_3[0][0]                  
2024-03-20 00:32:32.801889:__________________________________________________________________________________________________
2024-03-20 00:32:32.801970:tf.__operators__.add_13 (TFOpLa (None, 64)           0           fc4_0[0][0]                      
2024-03-20 00:32:32.802013:                                                                 fc4_dim_0[0][0]                  
2024-03-20 00:32:32.802049:__________________________________________________________________________________________________
2024-03-20 00:32:32.802148:fc4_1 (Dense)                   (None, 64)           4160        tf.__operators__.add_13[0][0]    
2024-03-20 00:32:32.802189:__________________________________________________________________________________________________
2024-03-20 00:32:32.802263:tf.__operators__.add_14 (TFOpLa (None, 64)           0           fc4_1[0][0]                      
2024-03-20 00:32:32.802305:                                                                 tf.__operators__.add_13[0][0]    
2024-03-20 00:32:32.802340:__________________________________________________________________________________________________
2024-03-20 00:32:32.802439:fc5_0 (Dense)                   (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-03-20 00:32:32.802491:__________________________________________________________________________________________________
2024-03-20 00:32:32.802595:fc5_dim_0 (Dense)               (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-03-20 00:32:32.803892:__________________________________________________________________________________________________
2024-03-20 00:32:32.803981:tf.__operators__.add_15 (TFOpLa (None, 32)           0           fc5_0[0][0]                      
2024-03-20 00:32:32.804025:                                                                 fc5_dim_0[0][0]                  
2024-03-20 00:32:32.804060:__________________________________________________________________________________________________
2024-03-20 00:32:32.804163:fc6 (Dense)                     (None, 1)            33          tf.__operators__.add_15[0][0]    
2024-03-20 00:32:32.804204:==================================================================================================
2024-03-20 00:32:32.804837:Total params: 8,389,409
2024-03-20 00:32:32.804887:Trainable params: 8,389,409
2024-03-20 00:32:32.804924:Non-trainable params: 0
2024-03-20 00:32:32.804958:__________________________________________________________________________________________________
2024-03-20 00:32:32.815849:start training
2024-03-20 00:32:38.550773:2024-03-20 00:32:38.550723: Current epoch: 0, loss: 3.7679216861724854, validation loss: 1.6405045986175537
2024-03-20 00:32:42.878030:2024-03-20 00:32:42.877957: Current epoch: 1, loss: 1.3495023250579834, validation loss: 0.9437033534049988
2024-03-20 00:32:47.069390:2024-03-20 00:32:47.069336: Current epoch: 2, loss: 0.9705538153648376, validation loss: 0.8654174208641052
2024-03-20 00:32:51.338951:2024-03-20 00:32:51.338799: Current epoch: 3, loss: 0.839819073677063, validation loss: 1.0322155952453613