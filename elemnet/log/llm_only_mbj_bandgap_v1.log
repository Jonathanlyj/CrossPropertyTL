
2024-02-14 09:19:41.047427:job config: {'train_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_bert-base-uncased_chemnlp_prop_mbj_bandgap.csv', 'val_data_path': None, 'test_data_path': None, 'label': 'mbj_bandgap', 'input_type': None, 'log_folder': 'log', 'log_file': 'llm_only_mbj_bandgap.log', 'test_metric': 'mae', 'architecture': '1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1', 'model_seed': 0, 'loss_type': 'mae', 'config_file': 'sample/llm_only_mbj_bandgap_job.config', 'use_valid': True, 'project': 'MOF', 'regressors': None, 'input_types': None, 'paramsGrid': {'optimizer': 'Adam', 'learning_rate': 0.0001, 'patience': 200, 'dropouts': [0.8, 0.9, 0.7, 0.8], 'EVAL_FREQUENCY': 1000}, 'save_path': 'sample/llm_only_mbj_bandgap', 'model_path': None, 'last_layer_with_weight': True, 'keras_path': 'model/llm_only_mbj_bandgap', 'test_size': 0.1, 'val_size': 0.1}
2024-02-14 09:19:41.047508:train data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_bert-base-uncased_chemnlp_prop_mbj_bandgap.csv
2024-02-14 09:19:43.326705:input attribute sets are:  None
2024-02-14 09:19:43.327100:splitting data into with test ratio= 0.1
2024-02-14 09:20:01.439663:input attributes are:  Index(['0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
       ...
       '758', '759', '760', '761', '762', '763', '764', '765', '766', '767'],
      dtype='object', length=768)
2024-02-14 09:20:01.440038:label: mbj_bandgap
2024-02-14 09:20:06.462012: train, test, valid sizes:  (15648, 768) (15648,) (1957, 768) (1957,) (1957, 768) (1957,)
2024-02-14 09:20:06.614059:train matrix shape of train_X:  (15648, 768)  train_y:  (15648,)
2024-02-14 09:20:06.614258:valid matrix shape of train_X:  (1957, 768)  valid_y:  (1957,)
2024-02-14 09:20:06.614305:test matrix shape of valid_X:   (1957, 768)  test_y:  (1957,)
2024-02-14 09:20:06.614341:architecture is:  1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1
2024-02-14 09:20:06.614379:learning rate is  0.0001
2024-02-14 09:20:06.614430:model path is  None
2024-02-14 09:20:06.634462:adding fully connected layers with 1024 outputs
2024-02-14 09:20:06.991916:adding residual with fc as the size are different
2024-02-14 09:20:06.999087:adding fully connected layers with 1024 outputs
2024-02-14 09:20:07.011013:adding residual, both sizes are same
2024-02-14 09:20:07.014071:adding fully connected layers with 1024 outputs
2024-02-14 09:20:07.021377:adding residual, both sizes are same
2024-02-14 09:20:07.023289:adding fully connected layers with 1024 outputs
2024-02-14 09:20:07.028118:adding residual, both sizes are same
2024-02-14 09:20:07.030111:adding dropout 0.8
2024-02-14 09:20:07.034636:adding fully connected layers with 512 outputs
2024-02-14 09:20:07.039641:adding residual with fc as the size are different
2024-02-14 09:20:07.046119:adding fully connected layers with 512 outputs
2024-02-14 09:20:07.051113:adding residual, both sizes are same
2024-02-14 09:20:07.053047:adding fully connected layers with 512 outputs
2024-02-14 09:20:07.058105:adding residual, both sizes are same
2024-02-14 09:20:07.060047:adding dropout 0.9
2024-02-14 09:20:07.061698:adding fully connected layers with 256 outputs
2024-02-14 09:20:07.072819:adding residual with fc as the size are different
2024-02-14 09:20:07.083214:adding fully connected layers with 256 outputs
2024-02-14 09:20:07.088198:adding residual, both sizes are same
2024-02-14 09:20:07.090113:adding fully connected layers with 256 outputs
2024-02-14 09:20:07.095151:adding residual, both sizes are same
2024-02-14 09:20:07.097059:adding dropout 0.7
2024-02-14 09:20:07.101542:adding fully connected layers with 128 outputs
2024-02-14 09:20:07.116945:adding residual with fc as the size are different
2024-02-14 09:20:07.128713:adding fully connected layers with 128 outputs
2024-02-14 09:20:07.134209:adding residual, both sizes are same
2024-02-14 09:20:07.136134:adding fully connected layers with 128 outputs
2024-02-14 09:20:07.140973:adding residual, both sizes are same
2024-02-14 09:20:07.143142:adding dropout 0.8
2024-02-14 09:20:07.145005:adding fully connected layers with 64 outputs
2024-02-14 09:20:07.150081:adding residual with fc as the size are different
2024-02-14 09:20:07.156423:adding fully connected layers with 64 outputs
2024-02-14 09:20:07.161680:adding residual, both sizes are same
2024-02-14 09:20:07.163604:adding fully connected layers with 32 outputs
2024-02-14 09:20:07.168719:adding residual with fc as the size are different
2024-02-14 09:20:07.175249:adding final layer with 1 output
2024-02-14 09:20:07.185249:Model: "ElemNet"
2024-02-14 09:20:07.185324:__________________________________________________________________________________________________
2024-02-14 09:20:07.185376:Layer (type)                    Output Shape         Param #     Connected to                     
2024-02-14 09:20:07.185419:==================================================================================================
2024-02-14 09:20:07.185641:elemental_fractions (InputLayer [(None, 768)]        0                                            
2024-02-14 09:20:07.185689:__________________________________________________________________________________________________
2024-02-14 09:20:07.185863:fc0_0 (Dense)                   (None, 1024)         787456      elemental_fractions[0][0]        
2024-02-14 09:20:07.185910:__________________________________________________________________________________________________
2024-02-14 09:20:07.186026:fc0_dim_0 (Dense)               (None, 1024)         787456      elemental_fractions[0][0]        
2024-02-14 09:20:07.186070:__________________________________________________________________________________________________
2024-02-14 09:20:07.186156:tf.__operators__.add (TFOpLambd (None, 1024)         0           fc0_0[0][0]                      
2024-02-14 09:20:07.186202:                                                                 fc0_dim_0[0][0]                  
2024-02-14 09:20:07.186240:__________________________________________________________________________________________________
2024-02-14 09:20:07.186348:fc0_1 (Dense)                   (None, 1024)         1049600     tf.__operators__.add[0][0]       
2024-02-14 09:20:07.186391:__________________________________________________________________________________________________
2024-02-14 09:20:07.186480:tf.__operators__.add_1 (TFOpLam (None, 1024)         0           fc0_1[0][0]                      
2024-02-14 09:20:07.186525:                                                                 tf.__operators__.add[0][0]       
2024-02-14 09:20:07.186562:__________________________________________________________________________________________________
2024-02-14 09:20:07.186669:fc0_2 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_1[0][0]     
2024-02-14 09:20:07.186712:__________________________________________________________________________________________________
2024-02-14 09:20:07.186791:tf.__operators__.add_2 (TFOpLam (None, 1024)         0           fc0_2[0][0]                      
2024-02-14 09:20:07.186835:                                                                 tf.__operators__.add_1[0][0]     
2024-02-14 09:20:07.186872:__________________________________________________________________________________________________
2024-02-14 09:20:07.186976:fc0_3 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_2[0][0]     
2024-02-14 09:20:07.187019:__________________________________________________________________________________________________
2024-02-14 09:20:07.187097:tf.__operators__.add_3 (TFOpLam (None, 1024)         0           fc0_3[0][0]                      
2024-02-14 09:20:07.187141:                                                                 tf.__operators__.add_2[0][0]     
2024-02-14 09:20:07.187178:__________________________________________________________________________________________________
2024-02-14 09:20:07.187255:dropout (Dropout)               (None, 1024)         0           tf.__operators__.add_3[0][0]     
2024-02-14 09:20:07.187295:__________________________________________________________________________________________________
2024-02-14 09:20:07.187418:fc1_0 (Dense)                   (None, 512)          524800      dropout[0][0]                    
2024-02-14 09:20:07.187464:__________________________________________________________________________________________________
2024-02-14 09:20:07.187571:fc1_dim_0 (Dense)               (None, 512)          524800      dropout[0][0]                    
2024-02-14 09:20:07.187615:__________________________________________________________________________________________________
2024-02-14 09:20:07.187695:tf.__operators__.add_4 (TFOpLam (None, 512)          0           fc1_0[0][0]                      
2024-02-14 09:20:07.187739:                                                                 fc1_dim_0[0][0]                  
2024-02-14 09:20:07.187777:__________________________________________________________________________________________________
2024-02-14 09:20:07.187880:fc1_1 (Dense)                   (None, 512)          262656      tf.__operators__.add_4[0][0]     
2024-02-14 09:20:07.187923:__________________________________________________________________________________________________
2024-02-14 09:20:07.188001:tf.__operators__.add_5 (TFOpLam (None, 512)          0           fc1_1[0][0]                      
2024-02-14 09:20:07.188045:                                                                 tf.__operators__.add_4[0][0]     
2024-02-14 09:20:07.188082:__________________________________________________________________________________________________
2024-02-14 09:20:07.188185:fc1_2 (Dense)                   (None, 512)          262656      tf.__operators__.add_5[0][0]     
2024-02-14 09:20:07.188228:__________________________________________________________________________________________________
2024-02-14 09:20:07.188305:tf.__operators__.add_6 (TFOpLam (None, 512)          0           fc1_2[0][0]                      
2024-02-14 09:20:07.188349:                                                                 tf.__operators__.add_5[0][0]     
2024-02-14 09:20:07.188386:__________________________________________________________________________________________________
2024-02-14 09:20:07.188467:dropout_1 (Dropout)             (None, 512)          0           tf.__operators__.add_6[0][0]     
2024-02-14 09:20:07.188507:__________________________________________________________________________________________________
2024-02-14 09:20:07.188614:fc2_0 (Dense)                   (None, 256)          131328      dropout_1[0][0]                  
2024-02-14 09:20:07.188657:__________________________________________________________________________________________________
2024-02-14 09:20:07.188761:fc2_dim_0 (Dense)               (None, 256)          131328      dropout_1[0][0]                  
2024-02-14 09:20:07.188804:__________________________________________________________________________________________________
2024-02-14 09:20:07.188882:tf.__operators__.add_7 (TFOpLam (None, 256)          0           fc2_0[0][0]                      
2024-02-14 09:20:07.188926:                                                                 fc2_dim_0[0][0]                  
2024-02-14 09:20:07.188963:__________________________________________________________________________________________________
2024-02-14 09:20:07.189065:fc2_1 (Dense)                   (None, 256)          65792       tf.__operators__.add_7[0][0]     
2024-02-14 09:20:07.189108:__________________________________________________________________________________________________
2024-02-14 09:20:07.189185:tf.__operators__.add_8 (TFOpLam (None, 256)          0           fc2_1[0][0]                      
2024-02-14 09:20:07.189229:                                                                 tf.__operators__.add_7[0][0]     
2024-02-14 09:20:07.189266:__________________________________________________________________________________________________
2024-02-14 09:20:07.189368:fc2_2 (Dense)                   (None, 256)          65792       tf.__operators__.add_8[0][0]     
2024-02-14 09:20:07.189432:__________________________________________________________________________________________________
2024-02-14 09:20:07.189522:tf.__operators__.add_9 (TFOpLam (None, 256)          0           fc2_2[0][0]                      
2024-02-14 09:20:07.189566:                                                                 tf.__operators__.add_8[0][0]     
2024-02-14 09:20:07.189603:__________________________________________________________________________________________________
2024-02-14 09:20:07.189678:dropout_2 (Dropout)             (None, 256)          0           tf.__operators__.add_9[0][0]     
2024-02-14 09:20:07.189717:__________________________________________________________________________________________________
2024-02-14 09:20:07.189823:fc3_0 (Dense)                   (None, 128)          32896       dropout_2[0][0]                  
2024-02-14 09:20:07.189866:__________________________________________________________________________________________________
2024-02-14 09:20:07.189969:fc3_dim_0 (Dense)               (None, 128)          32896       dropout_2[0][0]                  
2024-02-14 09:20:07.190011:__________________________________________________________________________________________________
2024-02-14 09:20:07.190089:tf.__operators__.add_10 (TFOpLa (None, 128)          0           fc3_0[0][0]                      
2024-02-14 09:20:07.190133:                                                                 fc3_dim_0[0][0]                  
2024-02-14 09:20:07.190170:__________________________________________________________________________________________________
2024-02-14 09:20:07.190272:fc3_1 (Dense)                   (None, 128)          16512       tf.__operators__.add_10[0][0]    
2024-02-14 09:20:07.190314:__________________________________________________________________________________________________
2024-02-14 09:20:07.190390:tf.__operators__.add_11 (TFOpLa (None, 128)          0           fc3_1[0][0]                      
2024-02-14 09:20:07.190440:                                                                 tf.__operators__.add_10[0][0]    
2024-02-14 09:20:07.190477:__________________________________________________________________________________________________
2024-02-14 09:20:07.190580:fc3_2 (Dense)                   (None, 128)          16512       tf.__operators__.add_11[0][0]    
2024-02-14 09:20:07.190622:__________________________________________________________________________________________________
2024-02-14 09:20:07.190700:tf.__operators__.add_12 (TFOpLa (None, 128)          0           fc3_2[0][0]                      
2024-02-14 09:20:07.190743:                                                                 tf.__operators__.add_11[0][0]    
2024-02-14 09:20:07.190779:__________________________________________________________________________________________________
2024-02-14 09:20:07.190853:dropout_3 (Dropout)             (None, 128)          0           tf.__operators__.add_12[0][0]    
2024-02-14 09:20:07.190892:__________________________________________________________________________________________________
2024-02-14 09:20:07.190996:fc4_0 (Dense)                   (None, 64)           8256        dropout_3[0][0]                  
2024-02-14 09:20:07.191038:__________________________________________________________________________________________________
2024-02-14 09:20:07.191142:fc4_dim_0 (Dense)               (None, 64)           8256        dropout_3[0][0]                  
2024-02-14 09:20:07.191185:__________________________________________________________________________________________________
2024-02-14 09:20:07.191268:tf.__operators__.add_13 (TFOpLa (None, 64)           0           fc4_0[0][0]                      
2024-02-14 09:20:07.191312:                                                                 fc4_dim_0[0][0]                  
2024-02-14 09:20:07.191348:__________________________________________________________________________________________________
2024-02-14 09:20:07.191463:fc4_1 (Dense)                   (None, 64)           4160        tf.__operators__.add_13[0][0]    
2024-02-14 09:20:07.191512:__________________________________________________________________________________________________
2024-02-14 09:20:07.191591:tf.__operators__.add_14 (TFOpLa (None, 64)           0           fc4_1[0][0]                      
2024-02-14 09:20:07.191635:                                                                 tf.__operators__.add_13[0][0]    
2024-02-14 09:20:07.191672:__________________________________________________________________________________________________
2024-02-14 09:20:07.191775:fc5_0 (Dense)                   (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-02-14 09:20:07.191817:__________________________________________________________________________________________________
2024-02-14 09:20:07.191919:fc5_dim_0 (Dense)               (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-02-14 09:20:07.195995:__________________________________________________________________________________________________
2024-02-14 09:20:07.196090:tf.__operators__.add_15 (TFOpLa (None, 32)           0           fc5_0[0][0]                      
2024-02-14 09:20:07.196135:                                                                 fc5_dim_0[0][0]                  
2024-02-14 09:20:07.196172:__________________________________________________________________________________________________
2024-02-14 09:20:07.196279:fc6 (Dense)                     (None, 1)            33          tf.__operators__.add_15[0][0]    
2024-02-14 09:20:07.196322:==================================================================================================
2024-02-14 09:20:07.196956:Total params: 6,816,545
2024-02-14 09:20:07.197010:Trainable params: 6,816,545
2024-02-14 09:20:07.197048:Non-trainable params: 0
2024-02-14 09:20:07.197083:__________________________________________________________________________________________________
2024-02-14 09:20:07.207274:start training
2024-02-14 09:20:12.572367:2024-02-14 09:20:12.572298: Current epoch: 0, loss: 2.7245328426361084, validation loss: 1.7262935638427734
2024-02-14 09:20:16.732320:2024-02-14 09:20:16.732256: Current epoch: 1, loss: 1.4247633218765259, validation loss: 1.2151545286178589
2024-02-14 09:20:20.871614:2024-02-14 09:20:20.871559: Current epoch: 2, loss: 1.2995243072509766, validation loss: 1.1208984851837158
2024-02-14 09:20:24.900951:2024-02-14 09:20:24.900875: Current epoch: 3, loss: 1.2317924499511719, validation loss: 1.1832355260849
2024-02-14 09:20:28.812597:2024-02-14 09:20:28.812420: Current epoch: 4, loss: 1.1771613359451294, validation loss: 1.2403532266616821
2024-02-14 09:20:29.144715:the test error is  [1.1974072456359863, 1.1974072456359863]
2024-02-14 09:20:31.651264:saved model to sample/llm_only_mbj_bandgap
2024-02-14 09:20:32.010848:done