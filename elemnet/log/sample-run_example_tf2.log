
2024-01-24 22:36:04.956635:job config: {'train_data_path': '../data/sample/sample_train_set.csv', 'val_data_path': '../data/sample/sample_validation_set.csv', 'test_data_path': '../data/sample/sample_test_set.csv', 'label': 'formation_energy_peratom', 'input_type': None, 'log_folder': 'log', 'log_file': 'sample-run_example_tf2.log', 'test_metric': 'mae', 'architecture': '1024x4D-512x3D-256x3D-128x3D-64x2-32x1-1', 'loss_type': 'mae', 'config_file': 'sample/job.config', 'use_valid': True, 'project': 'ElemNet', 'input_types': ['elements_tl'], 'regressors': None, 'paramsGrid': {'optimizer': 'Adam', 'learning_rate': 0.0001, 'patience': 200, 'dropouts': [0.8, 0.9, 0.7, 0.8], 'EVAL_FREQUENCY': 1000}, 'save_path': 'sample/sample-run_example_tf2', 'dataset': 'OQMD', 'model_path': None, 'last_layer_with_weight': True, 'keras_path': 'model/sample-run_example_tf2'}
2024-01-24 22:36:04.956686:train data path is  ../data/sample/sample_train_set.csv
2024-01-24 22:36:04.969041:input attribute sets are:  ['elements_tl']
2024-01-24 22:36:04.969117:test data path is  ../data/sample/sample_test_set.csv
2024-01-24 22:36:04.975141:val data path is  ../data/sample/sample_validation_set.csv
2024-01-24 22:36:04.981105:input attributes are:  ['H', 'Li', 'Be', 'B', 'C', 'N', 'O', 'F', 'Na', 'Mg', 'Al', 'Si', 'P', 'S', 'Cl', 'K', 'Ca', 'Sc', 'Ti', 'V', 'Cr', 'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga', 'Ge', 'As', 'Se', 'Br', 'Kr', 'Rb', 'Sr', 'Y', 'Zr', 'Nb', 'Mo', 'Tc', 'Ru', 'Rh', 'Pd', 'Ag', 'Cd', 'In', 'Sn', 'Sb', 'Te', 'I', 'Xe', 'Cs', 'Ba', 'La', 'Ce', 'Pr', 'Nd', 'Pm', 'Sm', 'Eu', 'Gd', 'Tb', 'Dy', 'Ho', 'Er', 'Tm', 'Yb', 'Lu', 'Hf', 'Ta', 'W', 'Re', 'Os', 'Ir', 'Pt', 'Au', 'Hg', 'Tl', 'Pb', 'Bi', 'Ac', 'Th', 'Pa', 'U', 'Np', 'Pu']
2024-01-24 22:36:04.981169:label: formation_energy_peratom
2024-01-24 22:36:05.615403: train, test, valid sizes:  (451, 86) (451,) (56, 86) (56,) (50, 86) (50,)
2024-01-24 22:36:05.615568:train matrix shape of train_X:  (451, 86)  train_y:  (451,)
2024-01-24 22:36:05.615623:valid matrix shape of train_X:  (50, 86)  valid_y:  (50,)
2024-01-24 22:36:05.615660:test matrix shape of valid_X:   (56, 86)  test_y:  (56,)
2024-01-24 22:36:05.615691:architecture is:  1024x4D-512x3D-256x3D-128x3D-64x2-32x1-1
2024-01-24 22:36:05.615724:learning rate is  0.0001
2024-01-24 22:36:05.615755:model path is  None
2024-01-24 22:36:05.630499:adding fully connected layers with 1024 outputs
2024-01-24 22:36:07.847160:adding fully connected layers with 1024 outputs
2024-01-24 22:36:07.854595:adding fully connected layers with 1024 outputs
2024-01-24 22:36:07.859694:adding fully connected layers with 1024 outputs
2024-01-24 22:36:07.864733:adding dropout 0.8
2024-01-24 22:36:07.871172:adding fully connected layers with 512 outputs
2024-01-24 22:36:07.876230:adding fully connected layers with 512 outputs
2024-01-24 22:36:07.881332:adding fully connected layers with 512 outputs
2024-01-24 22:36:07.886138:adding dropout 0.9
2024-01-24 22:36:07.887912:adding fully connected layers with 256 outputs
2024-01-24 22:36:07.893015:adding fully connected layers with 256 outputs
2024-01-24 22:36:07.898123:adding fully connected layers with 256 outputs
2024-01-24 22:36:07.902773:adding dropout 0.7
2024-01-24 22:36:07.904433:adding fully connected layers with 128 outputs
2024-01-24 22:36:07.909466:adding fully connected layers with 128 outputs
2024-01-24 22:36:07.914629:adding fully connected layers with 128 outputs
2024-01-24 22:36:07.919266:adding dropout 0.8
2024-01-24 22:36:07.920957:adding fully connected layers with 64 outputs
2024-01-24 22:36:07.926106:adding fully connected layers with 64 outputs
2024-01-24 22:36:07.931239:adding fully connected layers with 32 outputs
2024-01-24 22:36:07.936221:adding final layer with 1 output
2024-01-24 22:36:07.946038:Model: "ElemNet"
2024-01-24 22:36:07.946107:_________________________________________________________________
2024-01-24 22:36:07.946159:Layer (type)                 Output Shape              Param #   
2024-01-24 22:36:07.946196:=================================================================
2024-01-24 22:36:07.946434:elemental_fractions (InputLa [(None, 86)]              0         
2024-01-24 22:36:07.946489:_________________________________________________________________
2024-01-24 22:36:07.946881:fc0_0 (Dense)                (None, 1024)              89088     
2024-01-24 22:36:07.946933:_________________________________________________________________
2024-01-24 22:36:07.947046:fc0_1 (Dense)                (None, 1024)              1049600   
2024-01-24 22:36:07.947088:_________________________________________________________________
2024-01-24 22:36:07.947187:fc0_2 (Dense)                (None, 1024)              1049600   
2024-01-24 22:36:07.947228:_________________________________________________________________
2024-01-24 22:36:07.947323:fc0_3 (Dense)                (None, 1024)              1049600   
2024-01-24 22:36:07.947366:_________________________________________________________________
2024-01-24 22:36:07.947446:dropout (Dropout)            (None, 1024)              0         
2024-01-24 22:36:07.947485:_________________________________________________________________
2024-01-24 22:36:07.947583:fc1_0 (Dense)                (None, 512)               524800    
2024-01-24 22:36:07.947623:_________________________________________________________________
2024-01-24 22:36:07.947716:fc1_1 (Dense)                (None, 512)               262656    
2024-01-24 22:36:07.947756:_________________________________________________________________
2024-01-24 22:36:07.947848:fc1_2 (Dense)                (None, 512)               262656    
2024-01-24 22:36:07.947888:_________________________________________________________________
2024-01-24 22:36:07.947955:dropout_1 (Dropout)          (None, 512)               0         
2024-01-24 22:36:07.947993:_________________________________________________________________
2024-01-24 22:36:07.948084:fc2_0 (Dense)                (None, 256)               131328    
2024-01-24 22:36:07.948125:_________________________________________________________________
2024-01-24 22:36:07.948216:fc2_1 (Dense)                (None, 256)               65792     
2024-01-24 22:36:07.948256:_________________________________________________________________
2024-01-24 22:36:07.948348:fc2_2 (Dense)                (None, 256)               65792     
2024-01-24 22:36:07.948388:_________________________________________________________________
2024-01-24 22:36:07.948462:dropout_2 (Dropout)          (None, 256)               0         
2024-01-24 22:36:07.948501:_________________________________________________________________
2024-01-24 22:36:07.948592:fc3_0 (Dense)                (None, 128)               32896     
2024-01-24 22:36:07.948632:_________________________________________________________________
2024-01-24 22:36:07.948723:fc3_1 (Dense)                (None, 128)               16512     
2024-01-24 22:36:07.948762:_________________________________________________________________
2024-01-24 22:36:07.948853:fc3_2 (Dense)                (None, 128)               16512     
2024-01-24 22:36:07.948894:_________________________________________________________________
2024-01-24 22:36:07.948961:dropout_3 (Dropout)          (None, 128)               0         
2024-01-24 22:36:07.948998:_________________________________________________________________
2024-01-24 22:36:07.949089:fc4_0 (Dense)                (None, 64)                8256      
2024-01-24 22:36:07.949129:_________________________________________________________________
2024-01-24 22:36:07.949219:fc4_1 (Dense)                (None, 64)                4160      
2024-01-24 22:36:07.949259:_________________________________________________________________
2024-01-24 22:36:07.949350:fc5_0 (Dense)                (None, 32)                2080      
2024-01-24 22:36:07.949390:_________________________________________________________________
2024-01-24 22:36:07.949491:fc6 (Dense)                  (None, 1)                 33        
2024-01-24 22:36:07.949532:=================================================================
2024-01-24 22:36:07.949976:Total params: 4,631,361
2024-01-24 22:36:07.950032:Trainable params: 4,631,361
2024-01-24 22:36:07.950070:Non-trainable params: 0
2024-01-24 22:36:07.950104:_________________________________________________________________
2024-01-24 22:36:07.961555:start training
2024-01-24 22:36:09.075845:2024-01-24 22:36:09.075799: Current epoch: 0, loss: 0.9815524816513062, validation loss: 0.93048495054245
2024-01-24 22:36:09.217716:2024-01-24 22:36:09.217674: Current epoch: 1, loss: 0.7997897863388062, validation loss: 0.7121185064315796
2024-01-24 22:36:09.353289:2024-01-24 22:36:09.353248: Current epoch: 2, loss: 0.6401340365409851, validation loss: 0.6084871888160706
2024-01-24 22:36:09.495576:2024-01-24 22:36:09.495529: Current epoch: 3, loss: 0.5661632418632507, validation loss: 0.5356676578521729
2024-01-24 22:36:09.646047:2024-01-24 22:36:09.646001: Current epoch: 4, loss: 0.5051159858703613, validation loss: 0.5206021070480347
2024-01-24 22:36:09.802476:2024-01-24 22:36:09.802428: Current epoch: 5, loss: 0.4664856493473053, validation loss: 0.49102023243904114
2024-01-24 22:36:09.952600:2024-01-24 22:36:09.952553: Current epoch: 6, loss: 0.44909995794296265, validation loss: 0.46639975905418396
2024-01-24 22:36:10.103632:2024-01-24 22:36:10.103576: Current epoch: 7, loss: 0.4165864884853363, validation loss: 0.46311381459236145
2024-01-24 22:36:10.257280:2024-01-24 22:36:10.257238: Current epoch: 8, loss: 0.3699827790260315, validation loss: 0.4395608901977539
2024-01-24 22:36:10.402997:2024-01-24 22:36:10.402955: Current epoch: 9, loss: 0.33738842606544495, validation loss: 0.3943687379360199