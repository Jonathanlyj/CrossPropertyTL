
2024-03-19 20:52:30.517186:job config: {'train_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_train.csv', 'val_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_val.csv', 'test_data_path': '/data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_test.csv', 'label': 'mbj_bandgap', 'input_type': None, 'log_folder': 'log', 'log_file': 'alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap.log', 'test_metric': 'mae', 'architecture': '1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1', 'model_seed': 0, 'loss_type': 'mae', 'config_file': 'sample/alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_job.config', 'use_valid': True, 'project': 'MOF', 'regressors': None, 'input_types': None, 'paramsGrid': {'optimizer': 'Adam', 'learning_rate': 0.0001, 'patience': 100, 'dropouts': [0.8, 0.9, 0.7, 0.8], 'EVAL_FREQUENCY': 1000}, 'save_path': 'sample/alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap', 'model_path': None, 'last_layer_with_weight': True, 'keras_path': 'model/alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap', 'test_size': None, 'val_size': None}
2024-03-19 20:52:30.517241:train data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_train.csv
2024-03-19 20:52:33.873992:input attribute sets are:  None
2024-03-19 20:52:33.874320:test data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_test.csv
2024-03-19 20:52:34.312410:val data path is  /data/yll6162/alignntl_dft_3d/tl_dataset/dataset_alignn_bert-base-uncased_chemnlp_prop_mbj_bandgap_val.csv
2024-03-19 20:52:34.776297:input attributes are:  Index(['0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
       ...
       '758.1', '759.1', '760.1', '761.1', '762.1', '763.1', '764.1', '765.1',
       '766.1', '767.1'],
      dtype='object', length=1536)
2024-03-19 20:52:34.776421:label: mbj_bandgap
2024-03-19 20:52:40.853734: train, test, valid sizes:  (15642, 1536) (15642,) (1957, 1536) (1957,) (1957, 1536) (1957,)
2024-03-19 20:52:40.940135:train matrix shape of train_X:  (15642, 1536)  train_y:  (15642,)
2024-03-19 20:52:40.940297:valid matrix shape of train_X:  (1957, 1536)  valid_y:  (1957,)
2024-03-19 20:52:40.940337:test matrix shape of valid_X:   (1957, 1536)  test_y:  (1957,)
2024-03-19 20:52:40.940367:architecture is:  1024Rx4D-512Rx3D-256Rx3D-128Rx3D-64Rx2-32Rx1-1
2024-03-19 20:52:40.940400:learning rate is  0.0001
2024-03-19 20:52:40.940428:model path is  None
2024-03-19 20:52:40.945084:adding fully connected layers with 1024 outputs
2024-03-19 20:52:40.966530:adding residual with fc as the size are different
2024-03-19 20:52:40.973855:adding fully connected layers with 1024 outputs
2024-03-19 20:52:40.979259:adding residual, both sizes are same
2024-03-19 20:52:40.980864:adding fully connected layers with 1024 outputs
2024-03-19 20:52:40.989589:adding residual, both sizes are same
2024-03-19 20:52:40.991581:adding fully connected layers with 1024 outputs
2024-03-19 20:52:40.998336:adding residual, both sizes are same
2024-03-19 20:52:41.000253:adding dropout 0.8
2024-03-19 20:52:41.003241:adding fully connected layers with 512 outputs
2024-03-19 20:52:41.008310:adding residual with fc as the size are different
2024-03-19 20:52:41.014360:adding fully connected layers with 512 outputs
2024-03-19 20:52:41.019034:adding residual, both sizes are same
2024-03-19 20:52:41.020816:adding fully connected layers with 512 outputs
2024-03-19 20:52:41.025248:adding residual, both sizes are same
2024-03-19 20:52:41.026860:adding dropout 0.9
2024-03-19 20:52:41.028224:adding fully connected layers with 256 outputs
2024-03-19 20:52:41.032874:adding residual with fc as the size are different
2024-03-19 20:52:41.038602:adding fully connected layers with 256 outputs
2024-03-19 20:52:41.042885:adding residual, both sizes are same
2024-03-19 20:52:41.044674:adding fully connected layers with 256 outputs
2024-03-19 20:52:41.048833:adding residual, both sizes are same
2024-03-19 20:52:41.050477:adding dropout 0.7
2024-03-19 20:52:41.052791:adding fully connected layers with 128 outputs
2024-03-19 20:52:41.065099:adding residual with fc as the size are different
2024-03-19 20:52:41.079024:adding fully connected layers with 128 outputs
2024-03-19 20:52:41.084325:adding residual, both sizes are same
2024-03-19 20:52:41.086755:adding fully connected layers with 128 outputs
2024-03-19 20:52:41.090826:adding residual, both sizes are same
2024-03-19 20:52:41.092449:adding dropout 0.8
2024-03-19 20:52:41.093860:adding fully connected layers with 64 outputs
2024-03-19 20:52:41.098018:adding residual with fc as the size are different
2024-03-19 20:52:41.103209:adding fully connected layers with 64 outputs
2024-03-19 20:52:41.107131:adding residual, both sizes are same
2024-03-19 20:52:41.109012:adding fully connected layers with 32 outputs
2024-03-19 20:52:41.112861:adding residual with fc as the size are different
2024-03-19 20:52:41.117881:adding final layer with 1 output
2024-03-19 20:52:41.124936:Model: "ElemNet"
2024-03-19 20:52:41.124995:__________________________________________________________________________________________________
2024-03-19 20:52:41.125036:Layer (type)                    Output Shape         Param #     Connected to                     
2024-03-19 20:52:41.125067:==================================================================================================
2024-03-19 20:52:41.125201:elemental_fractions (InputLayer [(None, 1536)]       0                                            
2024-03-19 20:52:41.125236:__________________________________________________________________________________________________
2024-03-19 20:52:41.125371:fc0_0 (Dense)                   (None, 1024)         1573888     elemental_fractions[0][0]        
2024-03-19 20:52:41.125410:__________________________________________________________________________________________________
2024-03-19 20:52:41.125516:fc0_dim_0 (Dense)               (None, 1024)         1573888     elemental_fractions[0][0]        
2024-03-19 20:52:41.125553:__________________________________________________________________________________________________
2024-03-19 20:52:41.125620:tf.__operators__.add (TFOpLambd (None, 1024)         0           fc0_0[0][0]                      
2024-03-19 20:52:41.125656:                                                                 fc0_dim_0[0][0]                  
2024-03-19 20:52:41.125684:__________________________________________________________________________________________________
2024-03-19 20:52:41.125768:fc0_1 (Dense)                   (None, 1024)         1049600     tf.__operators__.add[0][0]       
2024-03-19 20:52:41.125803:__________________________________________________________________________________________________
2024-03-19 20:52:41.125866:tf.__operators__.add_1 (TFOpLam (None, 1024)         0           fc0_1[0][0]                      
2024-03-19 20:52:41.125900:                                                                 tf.__operators__.add[0][0]       
2024-03-19 20:52:41.125928:__________________________________________________________________________________________________
2024-03-19 20:52:41.126010:fc0_2 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_1[0][0]     
2024-03-19 20:52:41.126043:__________________________________________________________________________________________________
2024-03-19 20:52:41.126104:tf.__operators__.add_2 (TFOpLam (None, 1024)         0           fc0_2[0][0]                      
2024-03-19 20:52:41.126139:                                                                 tf.__operators__.add_1[0][0]     
2024-03-19 20:52:41.126167:__________________________________________________________________________________________________
2024-03-19 20:52:41.126248:fc0_3 (Dense)                   (None, 1024)         1049600     tf.__operators__.add_2[0][0]     
2024-03-19 20:52:41.126281:__________________________________________________________________________________________________
2024-03-19 20:52:41.126341:tf.__operators__.add_3 (TFOpLam (None, 1024)         0           fc0_3[0][0]                      
2024-03-19 20:52:41.126381:                                                                 tf.__operators__.add_2[0][0]     
2024-03-19 20:52:41.126410:__________________________________________________________________________________________________
2024-03-19 20:52:41.126481:dropout (Dropout)               (None, 1024)         0           tf.__operators__.add_3[0][0]     
2024-03-19 20:52:41.126513:__________________________________________________________________________________________________
2024-03-19 20:52:41.126600:fc1_0 (Dense)                   (None, 512)          524800      dropout[0][0]                    
2024-03-19 20:52:41.126634:__________________________________________________________________________________________________
2024-03-19 20:52:41.126715:fc1_dim_0 (Dense)               (None, 512)          524800      dropout[0][0]                    
2024-03-19 20:52:41.126749:__________________________________________________________________________________________________
2024-03-19 20:52:41.126809:tf.__operators__.add_4 (TFOpLam (None, 512)          0           fc1_0[0][0]                      
2024-03-19 20:52:41.126844:                                                                 fc1_dim_0[0][0]                  
2024-03-19 20:52:41.126873:__________________________________________________________________________________________________
2024-03-19 20:52:41.126954:fc1_1 (Dense)                   (None, 512)          262656      tf.__operators__.add_4[0][0]     
2024-03-19 20:52:41.126987:__________________________________________________________________________________________________
2024-03-19 20:52:41.127047:tf.__operators__.add_5 (TFOpLam (None, 512)          0           fc1_1[0][0]                      
2024-03-19 20:52:41.127081:                                                                 tf.__operators__.add_4[0][0]     
2024-03-19 20:52:41.127109:__________________________________________________________________________________________________
2024-03-19 20:52:41.127190:fc1_2 (Dense)                   (None, 512)          262656      tf.__operators__.add_5[0][0]     
2024-03-19 20:52:41.127223:__________________________________________________________________________________________________
2024-03-19 20:52:41.127282:tf.__operators__.add_6 (TFOpLam (None, 512)          0           fc1_2[0][0]                      
2024-03-19 20:52:41.127315:                                                                 tf.__operators__.add_5[0][0]     
2024-03-19 20:52:41.127343:__________________________________________________________________________________________________
2024-03-19 20:52:41.127401:dropout_1 (Dropout)             (None, 512)          0           tf.__operators__.add_6[0][0]     
2024-03-19 20:52:41.127431:__________________________________________________________________________________________________
2024-03-19 20:52:41.127878:fc2_0 (Dense)                   (None, 256)          131328      dropout_1[0][0]                  
2024-03-19 20:52:41.128066:__________________________________________________________________________________________________
2024-03-19 20:52:41.128433:fc2_dim_0 (Dense)               (None, 256)          131328      dropout_1[0][0]                  
2024-03-19 20:52:41.128589:__________________________________________________________________________________________________
2024-03-19 20:52:41.128835:tf.__operators__.add_7 (TFOpLam (None, 256)          0           fc2_0[0][0]                      
2024-03-19 20:52:41.128968:                                                                 fc2_dim_0[0][0]                  
2024-03-19 20:52:41.129077:__________________________________________________________________________________________________
2024-03-19 20:52:41.129383:fc2_1 (Dense)                   (None, 256)          65792       tf.__operators__.add_7[0][0]     
2024-03-19 20:52:41.129520:__________________________________________________________________________________________________
2024-03-19 20:52:41.129758:tf.__operators__.add_8 (TFOpLam (None, 256)          0           fc2_1[0][0]                      
2024-03-19 20:52:41.129887:                                                                 tf.__operators__.add_7[0][0]     
2024-03-19 20:52:41.129991:__________________________________________________________________________________________________
2024-03-19 20:52:41.130285:fc2_2 (Dense)                   (None, 256)          65792       tf.__operators__.add_8[0][0]     
2024-03-19 20:52:41.130405:__________________________________________________________________________________________________
2024-03-19 20:52:41.130642:tf.__operators__.add_9 (TFOpLam (None, 256)          0           fc2_2[0][0]                      
2024-03-19 20:52:41.130766:                                                                 tf.__operators__.add_8[0][0]     
2024-03-19 20:52:41.130868:__________________________________________________________________________________________________
2024-03-19 20:52:41.131082:dropout_2 (Dropout)             (None, 256)          0           tf.__operators__.add_9[0][0]     
2024-03-19 20:52:41.131193:__________________________________________________________________________________________________
2024-03-19 20:52:41.131497:fc3_0 (Dense)                   (None, 128)          32896       dropout_2[0][0]                  
2024-03-19 20:52:41.131615:__________________________________________________________________________________________________
2024-03-19 20:52:41.131900:fc3_dim_0 (Dense)               (None, 128)          32896       dropout_2[0][0]                  
2024-03-19 20:52:41.132017:__________________________________________________________________________________________________
2024-03-19 20:52:41.132233:tf.__operators__.add_10 (TFOpLa (None, 128)          0           fc3_0[0][0]                      
2024-03-19 20:52:41.132355:                                                                 fc3_dim_0[0][0]                  
2024-03-19 20:52:41.132467:__________________________________________________________________________________________________
2024-03-19 20:52:41.132756:fc3_1 (Dense)                   (None, 128)          16512       tf.__operators__.add_10[0][0]    
2024-03-19 20:52:41.132874:__________________________________________________________________________________________________
2024-03-19 20:52:41.133090:tf.__operators__.add_11 (TFOpLa (None, 128)          0           fc3_1[0][0]                      
2024-03-19 20:52:41.133212:                                                                 tf.__operators__.add_10[0][0]    
2024-03-19 20:52:41.133314:__________________________________________________________________________________________________
2024-03-19 20:52:41.133612:fc3_2 (Dense)                   (None, 128)          16512       tf.__operators__.add_11[0][0]    
2024-03-19 20:52:41.133728:__________________________________________________________________________________________________
2024-03-19 20:52:41.133939:tf.__operators__.add_12 (TFOpLa (None, 128)          0           fc3_2[0][0]                      
2024-03-19 20:52:41.134060:                                                                 tf.__operators__.add_11[0][0]    
2024-03-19 20:52:41.134163:__________________________________________________________________________________________________
2024-03-19 20:52:41.134368:dropout_3 (Dropout)             (None, 128)          0           tf.__operators__.add_12[0][0]    
2024-03-19 20:52:41.134492:__________________________________________________________________________________________________
2024-03-19 20:52:41.134781:fc4_0 (Dense)                   (None, 64)           8256        dropout_3[0][0]                  
2024-03-19 20:52:41.134897:__________________________________________________________________________________________________
2024-03-19 20:52:41.135176:fc4_dim_0 (Dense)               (None, 64)           8256        dropout_3[0][0]                  
2024-03-19 20:52:41.135294:__________________________________________________________________________________________________
2024-03-19 20:52:41.135532:tf.__operators__.add_13 (TFOpLa (None, 64)           0           fc4_0[0][0]                      
2024-03-19 20:52:41.135660:                                                                 fc4_dim_0[0][0]                  
2024-03-19 20:52:41.135762:__________________________________________________________________________________________________
2024-03-19 20:52:41.136042:fc4_1 (Dense)                   (None, 64)           4160        tf.__operators__.add_13[0][0]    
2024-03-19 20:52:41.136160:__________________________________________________________________________________________________
2024-03-19 20:52:41.136374:tf.__operators__.add_14 (TFOpLa (None, 64)           0           fc4_1[0][0]                      
2024-03-19 20:52:41.136511:                                                                 tf.__operators__.add_13[0][0]    
2024-03-19 20:52:41.136616:__________________________________________________________________________________________________
2024-03-19 20:52:41.136897:fc5_0 (Dense)                   (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-03-19 20:52:41.137014:__________________________________________________________________________________________________
2024-03-19 20:52:41.137239:fc5_dim_0 (Dense)               (None, 32)           2080        tf.__operators__.add_14[0][0]    
2024-03-19 20:52:41.137296:__________________________________________________________________________________________________
2024-03-19 20:52:41.137398:tf.__operators__.add_15 (TFOpLa (None, 32)           0           fc5_0[0][0]                      
2024-03-19 20:52:41.137463:                                                                 fc5_dim_0[0][0]                  
2024-03-19 20:52:41.137513:__________________________________________________________________________________________________
2024-03-19 20:52:41.137649:fc6 (Dense)                     (None, 1)            33          tf.__operators__.add_15[0][0]    
2024-03-19 20:52:41.137705:==================================================================================================
2024-03-19 20:52:41.138453:Total params: 8,389,409
2024-03-19 20:52:41.138557:Trainable params: 8,389,409
2024-03-19 20:52:41.138638:Non-trainable params: 0
2024-03-19 20:52:41.138694:__________________________________________________________________________________________________
2024-03-19 20:52:41.148333:start training
2024-03-19 20:54:06.598018:2024-03-19 20:54:06.596338: Current epoch: 0, loss: 4.041025161743164, validation loss: 1.2520592212677002
2024-03-19 20:55:24.693693:2024-03-19 20:55:24.689835: Current epoch: 1, loss: 1.268394112586975, validation loss: 1.0433616638183594
2024-03-19 20:56:40.025361:2024-03-19 20:56:40.025272: Current epoch: 2, loss: 0.932926595211029, validation loss: 1.1560804843902588
2024-03-19 20:57:54.382214:2024-03-19 20:57:54.382112: Current epoch: 3, loss: 0.8022201061248779, validation loss: 0.6303412318229675
2024-03-19 20:59:08.765640:2024-03-19 20:59:08.763700: Current epoch: 4, loss: 0.7284572720527649, validation loss: 0.6178748607635498
2024-03-19 21:00:24.603049:2024-03-19 21:00:24.598540: Current epoch: 5, loss: 0.6359239816665649, validation loss: 0.586637556552887
2024-03-19 21:01:47.098718:2024-03-19 21:01:47.098342: Current epoch: 6, loss: 0.6263284683227539, validation loss: 0.5920943021774292
2024-03-19 21:03:00.360102:2024-03-19 21:03:00.354554: Current epoch: 7, loss: 0.5654615759849548, validation loss: 0.5339395999908447
2024-03-19 21:04:09.994787:2024-03-19 21:04:09.994728: Current epoch: 8, loss: 0.5249465107917786, validation loss: 0.5422497391700745
2024-03-19 21:05:16.791488:2024-03-19 21:05:16.788242: Current epoch: 9, loss: 0.5440964698791504, validation loss: 0.502733051776886
2024-03-19 21:06:36.752989:2024-03-19 21:06:36.752902: Current epoch: 10, loss: 0.505476176738739, validation loss: 0.5342971086502075
2024-03-19 21:07:54.980730:2024-03-19 21:07:54.950381: Current epoch: 11, loss: 0.47212111949920654, validation loss: 0.46295076608657837
2024-03-19 21:09:08.538357:2024-03-19 21:09:08.538277: Current epoch: 12, loss: 0.4507841169834137, validation loss: 0.4405333697795868
2024-03-19 21:10:30.186313:2024-03-19 21:10:30.186126: Current epoch: 13, loss: 0.42760881781578064, validation loss: 0.5019988417625427
2024-03-19 21:11:52.159616:2024-03-19 21:11:52.159371: Current epoch: 14, loss: 0.429067999124527, validation loss: 0.5352479815483093
2024-03-19 21:13:13.243489:2024-03-19 21:13:13.243399: Current epoch: 15, loss: 0.3964797854423523, validation loss: 0.4557110667228699
2024-03-19 21:14:28.421790:2024-03-19 21:14:28.421645: Current epoch: 16, loss: 0.3875071704387665, validation loss: 0.41433951258659363
2024-03-19 21:15:47.159050:2024-03-19 21:15:47.143719: Current epoch: 17, loss: 0.3689973056316376, validation loss: 0.4104097783565521
2024-03-19 21:17:10.661654:2024-03-19 21:17:10.661567: Current epoch: 18, loss: 0.36631911993026733, validation loss: 0.4117511510848999
2024-03-19 21:18:30.201589:2024-03-19 21:18:30.196113: Current epoch: 19, loss: 0.3334611654281616, validation loss: 0.38915738463401794
2024-03-19 21:19:48.447894:2024-03-19 21:19:48.444740: Current epoch: 20, loss: 0.3251732885837555, validation loss: 0.3714706301689148
2024-03-19 21:21:07.629114:2024-03-19 21:21:07.628749: Current epoch: 21, loss: 0.33927860856056213, validation loss: 0.452085018157959
2024-03-19 21:22:21.026957:2024-03-19 21:22:21.026871: Current epoch: 22, loss: 0.3160034120082855, validation loss: 0.3765450417995453
2024-03-19 21:23:29.552709:2024-03-19 21:23:29.552406: Current epoch: 23, loss: 0.2905457019805908, validation loss: 0.59239262342453
2024-03-19 21:24:47.854943:2024-03-19 21:24:47.854777: Current epoch: 24, loss: 0.2949249744415283, validation loss: 0.3967093825340271
2024-03-19 21:26:05.529747:2024-03-19 21:26:05.527235: Current epoch: 25, loss: 0.27939146757125854, validation loss: 0.35080260038375854
2024-03-19 21:27:25.962789:2024-03-19 21:27:25.962697: Current epoch: 26, loss: 0.2636043131351471, validation loss: 0.35466524958610535
2024-03-19 21:28:42.117637:2024-03-19 21:28:42.117519: Current epoch: 27, loss: 0.2621839940547943, validation loss: 0.38859447836875916
2024-03-19 21:30:02.325895:2024-03-19 21:30:02.325584: Current epoch: 28, loss: 0.2570951282978058, validation loss: 0.3527018129825592
2024-03-19 21:31:24.190513:2024-03-19 21:31:24.180934: Current epoch: 29, loss: 0.2585194408893585, validation loss: 0.34094148874282837
2024-03-19 21:32:40.836480:2024-03-19 21:32:40.836355: Current epoch: 30, loss: 0.2542363107204437, validation loss: 0.3553006947040558
2024-03-19 21:34:01.826231:2024-03-19 21:34:01.826142: Current epoch: 31, loss: 0.23613473773002625, validation loss: 0.36145922541618347
2024-03-19 21:35:21.256352:2024-03-19 21:35:21.256264: Current epoch: 32, loss: 0.22973062098026276, validation loss: 0.3525323271751404